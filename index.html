<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>

    </style>
</head>
<body>
<h1></h1>
<svg id="barGraph" width="800" height="500"></svg>
<p id="p1">
</p> 
<script>
    d3.csv("disney_movies.csv", d3.autoType).then((data) => {
        const filteredMovies = data.filter(movie => {
            const releaseYear = new Date(movie.release_date).getFullYear();
            return releaseYear >= 2000 && movie.total_gross > 0;
        })

        const transformedMovies = filteredMovies.map(movie => {
            const releaseDate = new Date(movie.release_date);
            const month = releaseDate.toLocaleString('default', { month: 'long' }); 
            return {
                ...movie,
                release_date: month 
            };
        });
        console.log(transformedMovies);
        const colorScale = d3.scaleOrdinal(d3.schemeCategory10);

        const genres = Array.from(new Set(transformedMovies.map(movie => movie.genre)));
        const months = Array.from(new Set(transformedMovies.map(movie => movie.release_date)));

        const groupedData = d3.rollups(
            transformedMovies,
            v => d3.rollup(v, g => d3.sum(g, d => d.total_gross), d => d.genre),
            d => d.release_date)

        const stackedData = d3.stack()
            .keys(genres)
            .value((d, key) => d[1].get(key) || 0)(groupedData);

        console.log(stackedData);

        const colorScale = d3.scaleOrdinal()
            .domain(genres)
            .range(d3.schemeTableau10);

    }).catch(error => {
        console.log('Error:', error);
    })

</script>

<p id ='p2'>
<script>

</script>
</p> 
</body> 
</html>